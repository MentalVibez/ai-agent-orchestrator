# ============================================================
# AI Agent Orchestrator — Environment Configuration
# Copy this file to .env and fill in your values.
# ============================================================

# -----------------------------------------------------------
# LLM Provider Selection
# Options: bedrock | openai | ollama
# -----------------------------------------------------------
LLM_PROVIDER=bedrock

# -----------------------------------------------------------
# AWS Bedrock (used when LLM_PROVIDER=bedrock)
# -----------------------------------------------------------
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
LLM_MODEL=anthropic.claude-3-5-sonnet-20241022-v2:0

# -----------------------------------------------------------
# OpenAI (used when LLM_PROVIDER=openai)
# -----------------------------------------------------------
OPENAI_API_KEY=
OPENAI_MODEL=gpt-4o

# -----------------------------------------------------------
# Ollama — local/self-hosted (used when LLM_PROVIDER=ollama)
# -----------------------------------------------------------
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=llama3.2

# -----------------------------------------------------------
# API Security
# API_KEY is the bootstrap admin key (permanent, stored in env).
# For production, create named keys via POST /api/v1/admin/keys
# and revoke this env key once you have DB-managed keys set up.
# Generate with: openssl rand -hex 32
# -----------------------------------------------------------
API_KEY=change-me-in-production
REQUIRE_API_KEY=true
WEBHOOK_SECRET=

# Separate token for the Prometheus /metrics scrape endpoint.
# Standard Prometheus config: scrape_configs.bearer_token = <this value>
# If empty, /metrics falls back to using the main API_KEY.
# Generate with: openssl rand -hex 32
# METRICS_TOKEN=

# -----------------------------------------------------------
# Database
# Leave blank to use the default path inside the Docker volume.
# SQLite (local/single-instance): sqlite:///./orchestrator.db
# PostgreSQL (multi-instance/production): postgresql://user:pass@host:5432/dbname
# For PostgreSQL, run: alembic upgrade head
# -----------------------------------------------------------
# DATABASE_URL=sqlite:///./orchestrator.db
# DATABASE_URL=postgresql://user:pass@localhost:5432/orchestrator

# -----------------------------------------------------------
# Optional: Run queue (Redis). Empty = run planner in-process.
# When set, POST /run enqueues; run worker: RUN_QUEUE_URL=redis://... arq app.worker.WorkerSettings
# -----------------------------------------------------------
# RUN_QUEUE_URL=redis://localhost:6379

# -----------------------------------------------------------
# Optional: Use LLM to route POST /orchestrate tasks (default: keyword-based)
# -----------------------------------------------------------
# USE_LLM_ROUTING=false
# LLM_ROUTING_TIMEOUT_SECONDS=10

# -----------------------------------------------------------
# Optional: OpenTelemetry tracing (runs, planner steps, tool calls)
# -----------------------------------------------------------
# OTEL_ENABLED=false
# OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318/v1/traces

# -----------------------------------------------------------
# Optional: ChromaDB RAG persistence
# Empty = in-memory (data lost on restart). Requires chromadb>=0.4 installed.
# Set to a directory path to persist indexed documents across restarts.
# -----------------------------------------------------------
# CHROMA_PERSIST_DIRECTORY=/app/data/chroma

# -----------------------------------------------------------
# Reliability — Circuit Breaker
# Opens the LLM/MCP circuit after N consecutive failures.
# Resets (allows a probe request) after RESET_TIMEOUT seconds.
# -----------------------------------------------------------
# CIRCUIT_BREAKER_FAIL_MAX=5
# CIRCUIT_BREAKER_RESET_TIMEOUT=60

# -----------------------------------------------------------
# Reliability — Graceful Shutdown
# Seconds to wait for in-flight requests to complete on SIGTERM.
# -----------------------------------------------------------
# GRACEFUL_SHUTDOWN_TIMEOUT_SECONDS=30

# -----------------------------------------------------------
# Application
# -----------------------------------------------------------
DEBUG=false
LOG_LEVEL=INFO
# LOG_FORMAT=json   # json (default in prod) | text (default in dev/debug mode)
HOST=0.0.0.0
PORT=8000
